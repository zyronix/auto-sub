#import autosub
#import time
#import cgi

<html>
<head>
	<title>AutoSub</title>
</head>
<script language="JavaScript">

function clickFirstButton(divname,title,season)
    {
      var newurlall= "onClick=location.href='/config/skipShow/" + escape(title) + "/0'";
      var newurlseason= "onClick=location.href='/config/skipShow/" + escape(title) + "/" + season + "'";
      document.getElementById(divname).innerHTML = "<input type=button value='Skip " + title + "'" + newurlall +">\
      <input type=button value='Skip " + title + " Season " + season + "'" + newurlseason + ">";
    }
</script>
<body>
<a href='runNow'>Run Everything Now</a>
<p>
<a href='shutdown'>Shutdown</a>
<p>
<a href='/config'>Config</a>
<p>
#if $len($autosub.WANTEDQUEUE) >= 1
<form>
<input type="button" value="Update WipStatus" name="wipstatusbutton" onClick="location.href='/home/runwipStatusNow'">
<p>
<b>Wanted queue:</b>
<table border=1>
<tr>
	<td>Show name</td>
	<td>Season</td>
	<td>Episode</td>
	<td>Quality</td>
	<td>Source</td>
	<td>Procent Done</td>
	<td>Expected</td>
</tr>
#set $counter = 1
#for $var in $autosub.WANTEDQUEUE
#set $divname = "skipshow-" + $var['title'] + $var['season'] + $var['episode'] + $var['quality'] + str($counter)
#set $counter = $counter + 1
#set $functionname = "clickFirstButton(" + "'" + $divname + "'" + "," + "'" + $var['title'] + "'" + "," + "'" + $var['season'] + "'" +  ")"
<tr>
<td>$var['title']</td>
<td>$var['season']</td>
<td>$var['episode']</td>
<td>$var['quality']</td>

#if 'source' in $var.keys()
	<td>$var['source']</td>
#else
	<td>?</td>
#end if

#if 'WIPProc' in $var.keys()
<td>$var['WIPProc']</td>
#else
<td>?</td>
#end if

#if 'WIPDate' in $var.keys()
<td>$var['WIPDate']</td>
#else
<td>?</td>
#end if


<td><input type="button" value="Skip Show" name="$var['season']" onClick="$functionname">
</tr>
<tr>
	<td colspan="7" >
		<div ID="$divname"></div>
	</td>
</tr>

</tr>
#end for
</table>
#end if
<p>
#if $len($autosub.LASTESTDOWNLOAD) >= 1
<b>Last 10 subtitle:</b>
<table border=1>
<tr>
	<td>Show name</td>
	<td>Season</td>
	<td>Episode</td>
	<td>Quality</td>
	<td>Source</td>
	<td>Language</td>
</tr>
#for $var in $autosub.LASTESTDOWNLOAD
<tr>
<td>$var['title']</td>
<td>$var['season']</td>
<td>$var['episode']</td>
<td>$var['quality']</td>

#if 'source' in $var.keys()
	<td>$var['source']</td>
#else
	<td>?</td>
#end if

<td>$var['lang']</td>
</tr>
</form>
#end for
</table>
#end if
<p>
<table>
<tr>
	<td>
		Next RSSCheck in:
	</td> 
	<td>
		#try
		  $time.strftime('%H:%M:%S', $time.gmtime(($autosub.CHECKRSS.interval - ($time.time() - $autosub.CHECKRSS.lastrun) ))) <br>
		#except
		  Please wait... <br>
		#end try
	</td>
</tr>
<tr>
	<td>
		Next ScanDisk in: 
	</td>
	<td>
		#try
		  $time.strftime('%H:%M:%S', $time.gmtime(($autosub.SCANDISK.interval - ($time.time() - $autosub.SCANDISK.lastrun) ))) <br>
		#except
		  Please wait... <br>
		#end try
	</td>
</tr>
<tr>
	<td>
		Next CheckSub in: 
	</td>
	<td>
		#try
		  $time.strftime('%H:%M:%S', $time.gmtime(($autosub.CHECKSUB.interval - ($time.time() - $autosub.CHECKSUB.lastrun) ))) <br>
		#except
		  Please wait... <br>
		#end try
	</td>
</tr>
<tr>
	<td>
		Next WipStatus in:
	</td>
	<td>
		#try
		  $time.strftime('%H:%M:%S', $time.gmtime(($autosub.WIPSTATUS.interval - ($time.time() - $autosub.WIPSTATUS.lastrun) )))
		#except
		  Please wait... <br>
		#end try
	</td>
</tr>
</table>
</body>
</html>
